/* * FAV ANALYTICS - STYLE V106 FINAL
 * Features: Full System + Manager Analytics UI Polish + Indicators
 */

:root {
    /* --- PALETA DE CORES PADRÃO (DARK / ZINC THEME) --- */
    --bg-body: #09090b;
    --bg-panel: #18181b;
    --bg-elevated: #27272a;

    /* Cor do Header da Tabela */
    --bg-table-header: #1f1f22;

    --border: #27272a;
    --border-hover: #3f3f46;

    --text-main: #f4f4f5;
    --text-muted: #a1a1aa;

    /* Gradiente do Header (Dark) */
    --header-bg: linear-gradient(90deg, #121215 0%, #1c1c21 100%);

    /* Acentos e Status */
    --accent: #3b82f6;
    --accent-hover: #2563eb;
    --accent-glow: rgba(59, 130, 246, 0.15);

    --good: #10b981;
    --good-bg: rgba(16, 185, 129, 0.1);
    --warn: #f59e0b;
    --warn-bg: rgba(245, 158, 11, 0.1);
    --bad: #ef4444;
    --bad-bg: rgba(239, 68, 68, 0.1);

    /* Cores do Tooltip */
    --tooltip-bg: #3f3f46;
    --tooltip-text: #ffffff;

    --font-stack: 'Inter', system-ui, -apple-system, sans-serif;

    /* Força controles nativos escuros */
    color-scheme: dark;
}

/* --- TEMA CLARO (LIGHT MODE) --- */
[data-theme="light"] {
    --bg-body: #f4f4f5;
    --bg-panel: #ffffff;
    --bg-elevated: #e4e4e7;

    --bg-table-header: #e4e4e7;

    --border: #d4d4d8;
    --border-hover: #a1a1aa;

    --text-main: #18181b;
    --text-muted: #52525b;

    --header-bg: linear-gradient(90deg, #ffffff 0%, #f4f4f5 100%);

    /* Tooltip no light mode deve ser bem escuro para contraste */
    --tooltip-bg: #18181b;
    --tooltip-text: #ffffff;

    /* Reverte controles nativos para claro */
    color-scheme: light;
}

/* --- RESET GLOBAL --- */
* {
    box-sizing: border-box;
    outline: none;
    -webkit-tap-highlight-color: transparent;
}

body {
    margin: 0;
    padding: 0;
    font-family: var(--font-stack);
    background-color: var(--bg-body);
    color: var(--text-main);
    font-size: 14px;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* =================================================================
   --- MAGIC TRANSITION ---
   ================================================================= */
body,
.app-header,
.kpi-item,
.chart-card,
.modal-box,
.modal-header,
.stat-card,
.input-field,
select.input-field,
.month-inp-group,
.mig-header,
th,
td,
.btn-option,
.year-selector,
.view-toggles {
    transition: background-color 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94),
        color 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94),
        border-color 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94),
        box-shadow 0.5s ease;
}

/* --- SCROLLBARS --- */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: #3f3f46;
    border-radius: 4px;
    border: 2px solid var(--bg-body);
}

::-webkit-scrollbar-thumb:hover {
    background: #52525b;
}

/* --- LOADING OVERLAY --- */
#loading-overlay {
    position: fixed;
    inset: 0;
    background: var(--bg-body);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 15px;
}

.spinner {
    width: 40px;
    height: 40px;
    border: 3px solid var(--bg-elevated);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

.loading-text {
    color: var(--text-muted);
    font-size: 0.9rem;
    font-weight: 500;
    animation: pulse 1.5s infinite;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

@keyframes pulse {
    50% {
        opacity: 0.5;
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* --- ESTRUTURA PRINCIPAL --- */
.main-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    height: 100%;
    position: relative;
    overflow: hidden;
}

/* --- HEADER FIXO --- */
#static-header-group {
    position: relative;
    width: 100%;
    z-index: 50;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    flex-shrink: 0;
}

.app-header {
    background: var(--header-bg);
    border-bottom: 1px solid var(--border);
    padding: 10px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-left,
.header-right {
    display: flex;
    align-items: center;
    gap: 15px;
}

.logo {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 700;
    font-size: 1rem;
    color: var(--text-main);
    letter-spacing: -0.5px;
}

/* Filtro Dropdown */
.filter-wrapper {
    position: relative;
}

#sector-filter {
    appearance: none;
    -webkit-appearance: none;
    background: rgba(125, 125, 125, 0.1);
    color: var(--text-muted);
    border: 1px solid var(--border);
    padding: 0 30px 0 12px;
    height: 32px;
    border-radius: 6px;
    font-weight: 500;
    cursor: pointer;
    font-size: 0.85rem;
    min-width: 160px;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 10px center;
}

#period-filter-wrapper {
    display: flex;
    align-items: center;
    gap: 5px;
    background: rgba(125, 125, 125, 0.1);
    padding: 0 8px;
    border-radius: 6px;
    border: 1px solid var(--border);
    height: 32px;
    transition: 0.2s;
}

#period-filter-wrapper select {
    background: transparent;
    color: var(--text-muted);
    border: none;
    font-size: 0.85rem;
    outline: none;
    cursor: pointer;
    padding: 0;
    font-weight: 500;
    font-family: var(--font-stack);
}

#period-filter-wrapper i {
    color: var(--text-muted);
}

/* Hover States Harmonization */
#sector-filter:hover,
#period-filter-wrapper:hover {
    background-color: var(--bg-elevated);
    color: var(--text-main);
    border-color: var(--border-hover);
}

/* Ensure inner elements inherit color on hover */
#period-filter-wrapper:hover select,
#period-filter-wrapper:hover i,
#period-filter-wrapper:hover span {
    color: var(--text-main);
}

.filter-disabled {
    opacity: 0.5;
    pointer-events: none;
    filter: grayscale(1);
}

/* Fix para garantir que as opções do select fiquem com a cor certa */
#sector-filter option,
#an-start option,
#an-end option {
    background-color: var(--bg-panel);
    color: var(--text-main);
}

/* Botões do Header */
.year-selector,
.view-toggles {
    display: flex;
    gap: 2px;
    background: rgba(125, 125, 125, 0.1);
    padding: 2px;
    border-radius: 6px;
    border: 1px solid var(--border);
}

.year-btn,
.view-btn {
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.75rem;
    transition: 0.2s;
}

.year-btn.active,
.view-btn.active {
    background: var(--bg-panel);
    color: var(--accent);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.icon-btn {
    background: transparent;
    border: 1px solid transparent;
    color: var(--text-muted);
    width: 30px;
    height: 30px;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.icon-btn:hover {
    background: var(--bg-elevated);
    color: var(--text-main);
    border-color: var(--border);
}

/* --- KPI BAR --- */
.kpi-bar {
    display: flex;
    gap: 1px;
    background: var(--border);
    padding: 1px 0 0 0;
}

.kpi-item {
    flex: 1;
    background: var(--bg-panel);
    padding: 8px 15px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 60px;
}

.kpi-item:hover {
    background: var(--bg-elevated);
}

.kpi-label {
    font-size: 0.65rem;
    text-transform: uppercase;
    color: var(--text-muted);
    font-weight: 600;
    margin-bottom: 2px;
}

.kpi-value {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--text-main);
}

.kpi-item.bad .kpi-value {
    color: var(--bad);
}

.kpi-label-row {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 2px;
}

.tiny-btn {
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 0;
    width: 12px;
    height: 12px;
    cursor: pointer;
    opacity: 0.5;
}

.tiny-btn:hover {
    opacity: 1;
    color: var(--accent);
}

/* --- CONTEÚDO --- */
.content-viewport {
    flex: 1;
    padding: 20px 30px;
    overflow-y: auto;
    background: var(--bg-body);
    position: relative;
}

.view-pane {
    display: none;
}

.view-pane.active {
    display: block;
}

/* --- TABELA --- */
.table-wrapper {
    background: var(--bg-panel);
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
}

table {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
    table-layout: fixed;
}

tr {
    height: 50px;
}

.col-name {
    width: 22%;
    text-align: center;
    padding: 10px 5px;
    color: var(--text-main);
    font-weight: 500;
    white-space: normal;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.3;
    vertical-align: middle;
}

.col-meta {
    width: 8%;
    text-align: center;
    color: var(--accent);
    font-weight: 700;
}

th {
    background: var(--bg-table-header);
    color: var(--text-muted);
    font-size: 0.7rem;
    text-transform: uppercase;
    font-weight: 700;
    padding: 12px 5px;
    border-bottom: 1px solid var(--border);
    vertical-align: middle;
    text-align: center;
}

td {
    padding: 10px 5px;
    border-bottom: 1px solid var(--border);
    border-right: 1px solid var(--border);
    text-align: center;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 0.85rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    vertical-align: middle;
    position: relative;
    /* Necessário para o indicador (bolinha) */
}

tr:last-child td {
    border-bottom: none;
}

td:hover {
    background: var(--bg-elevated) !important;
    color: var(--text-main);
    filter: brightness(0.95);
}

.sector-header td {
    background: var(--bg-table-header);
    color: var(--text-main);
    font-weight: 800;
    padding: 8px 10px;
    font-size: 0.85rem;
    border-top: 1px solid var(--border);
}

.cell-good {
    color: var(--good);
    font-weight: 700;
}

.cell-bad {
    color: var(--bad);
    font-weight: 700;
}

.cell-empty {
    opacity: 0.2;
}

/* --- INDICADOR DE ANÁLISE NA TABELA --- */
/* Essa classe será adicionada via JS se houver análise no mês */
td.has-analysis::after {
    content: '';
    position: absolute;
    top: 5px;
    right: 5px;
    width: 6px;
    height: 6px;
    background-color: var(--accent);
    /* Cor do indicador (azul) */
    border-radius: 50%;
    box-shadow: 0 0 0 1px var(--bg-panel);
    /* Pequena borda para contraste */
    opacity: 0.8;
}

td.missing-analysis::after {
    content: '!';
    position: absolute;
    top: 2px;
    right: 2px;
    width: 12px;
    height: 12px;
    background-color: var(--bad);
    color: white;
    font-size: 8px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    box-shadow: 0 0 0 1px var(--bg-panel);
    animation: pulse-red 2s infinite;
}

@keyframes pulse-red {
    0% {
        box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
    }

    70% {
        box-shadow: 0 0 0 4px rgba(239, 68, 68, 0);
    }

    100% {
        box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
    }
}

/* Empty State */
.empty-state {
    padding: 60px 0;
    text-align: center;
    color: var(--text-muted);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
}

/* --- GRÁFICOS --- */
.charts-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
}

.chart-card {
    background: var(--bg-panel);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 10px;
}

.chart-card.full {
    grid-column: span 2;
}

.chart-card h3 {
    margin: 0 0 15px 0;
    color: var(--text-main);
    font-size: 0.95rem;
}

.chart-box {
    position: relative;
    height: 220px;
    width: 100%;
}

.chart-card.full .chart-box {
    height: 400px;
}

/* --- RESPONSIVIDADE (MOBILE/TABLET) --- */
@media (max-width: 1024px) {
    .charts-grid {
        grid-template-columns: 1fr;
    }

    .chart-card.full {
        grid-column: span 1;
    }

    .chart-header-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }

    .mini-kpi-group {
        width: 100%;
        justify-content: space-between;
    }
}

/* --- MODAIS & ANIMAÇÕES --- */

/* Keyframes para animação de entrada (Pop) */
@keyframes modal-pop {
    0% {
        transform: translateY(20px);
        opacity: 0;
    }

    100% {
        transform: translateY(0);
        opacity: 1;
    }
}

.modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
    z-index: 1000;
    display: none;
    align-items: center;
    justify-content: center;
    transition: opacity 0.3s ease;
}

.modal-overlay.open {
    display: flex;
    animation: fadeIn 0.3s forwards;
}

.modal-box {
    background: var(--bg-body);
    border: 1px solid var(--border);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px var(--border);
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    min-height: 600px;
    height: auto;
    max-height: 90vh;
    width: 950px;
    max-width: 95vw;
    opacity: 0;
}

.modal-overlay.open .modal-box {
    animation: modal-pop 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.modal-box.small {
    width: 380px;
    max-height: none;
    height: auto;
    min-height: auto;
}

.modal-header {
    padding: 15px 25px;
    border-bottom: 1px solid var(--border);
    background: var(--bg-panel);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
}

.modal-header h2,
.modal-header h3 {
    margin: 0;
    color: var(--text-main);
    font-size: 1.1rem;
    font-weight: 600;
}

.close-btn {
    background: transparent;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
}

.close-btn:hover {
    color: var(--text-main);
}

/* MODAL BODY */
.modal-body {
    padding: 20px 25px;
    overflow-y: auto;
    overflow-x: hidden;
    flex: 1;
    display: flex;
    flex-direction: column;
}

/* Stats Row */
.stats-row {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 10px;
    margin-bottom: 15px;
    flex-shrink: 0;
}

.stat-card {
    background: var(--bg-panel);
    border: 1px solid var(--border);
    padding: 10px 5px;
    border-radius: 10px;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 4px;
}

.stat-val {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text-main);
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.stat-val[data-tooltip] {
    overflow: visible !important;
}

.sub-stat {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-muted);
    opacity: 0.8;
    margin: 0;
    white-space: nowrap;
    cursor: help;
    position: relative;
}

.sub-stat:hover {
    color: var(--accent);
    opacity: 1;
}

.stat-label {
    font-size: 0.65rem;
    color: var(--text-muted);
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: 0.5px;
    margin: 0;
}

.stat-card.bordered {
    border-color: var(--border);
}

.stat-val.accent {
    color: var(--accent);
}

.logic-badge {
    font-size: 0.6rem;
    color: var(--text-muted);
    background: rgba(125, 125, 125, 0.1);
    padding: 2px 6px;
    border-radius: 4px;
    display: inline-block;
    align-self: center;
}

.badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: 600;
    font-size: 0.7rem;
}

.badge-good {
    background: var(--good-bg);
    color: var(--good);
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.badge-warn {
    background: var(--warn-bg);
    color: var(--warn);
    border: 1px solid rgba(245, 158, 11, 0.3);
}

.badge-bad {
    background: var(--bad-bg);
    color: var(--bad);
    border: 1px solid rgba(239, 68, 68, 0.3);
}

/* Timeline */
.timeline-area {
    margin-bottom: 10px;
    padding-top: 0;
    border-top: none;
    flex-shrink: 0;
}

.timeline-area h4 {
    margin: 0 0 10px 0;
    color: var(--text-main);
    font-size: 1rem;
}

.timeline-track {
    display: flex;
    width: 100%;
    justify-content: space-between;
    position: relative;
    padding: 5px 0;
}

.timeline-track::before {
    content: '';
    position: absolute;
    top: 10px;
    left: 10px;
    right: 10px;
    height: 1px;
    background: var(--border);
    z-index: 0;
}

.timeline-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 20px;
    cursor: help;
    z-index: 1;
    position: relative;
}

.tl-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--bg-panel);
    border: 2px solid var(--border);
}

.tl-dot:hover {
    transform: scale(1.3);
    border-color: var(--text-main);
}

/* =================================================================
   --- MANAGERIAL VIEW STYLES (NEW) ---
   ================================================================= */

.manager-header-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    background: var(--bg-panel);
    border: 1px solid var(--border);
    border-radius: 12px;
    margin-bottom: 20px;
    /* overflow: hidden; causes tooltip clipping */
}

.manager-header-grid>.manager-kpi-card:first-child {
    border-top-left-radius: 11px;
    border-bottom-left-radius: 11px;
}

.manager-header-grid>.manager-kpi-card:last-child {
    border-top-right-radius: 11px;
    border-bottom-right-radius: 11px;
}

.manager-kpi-card {
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
    border-right: 1px solid var(--border);
    transition: background 0.2s;
}

.manager-kpi-card:hover {
    background: var(--bg-elevated);
}

.mk-icon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-body);
    border: 1px solid var(--border);
}

.mk-icon.success {
    color: var(--good);
    background: rgba(16, 185, 129, 0.1);
    border-color: rgba(16, 185, 129, 0.2);
}

.mk-icon.warn {
    color: var(--warn);
    background: rgba(245, 158, 11, 0.1);
    border-color: rgba(245, 158, 11, 0.2);
}

.mk-icon.danger {
    color: var(--bad);
    background: rgba(239, 68, 68, 0.1);
    border-color: rgba(239, 68, 68, 0.2);
}

.mk-icon.info {
    color: #a855f7;
    background: rgba(168, 85, 247, 0.1);
    border-color: rgba(168, 85, 247, 0.2);
}

.mk-icon.primary {
    color: var(--accent);
    background: rgba(59, 130, 246, 0.1);
    border-color: rgba(59, 130, 246, 0.2);
}

.mk-content {
    display: flex;
    flex-direction: column;
}

.mk-label {
    font-size: 0.7rem;
    color: var(--text-muted);
    text-transform: uppercase;
    font-weight: 600;
}

.mk-value {
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--text-main);
    line-height: 1.2;
}

/* Grid Layout */
.manager-grid {
    display: flex;
    gap: 20px;
    height: calc(100vh - 220px);
    /* Ajuste para viewport */
}

/* Sections */
.manager-section {
    background: var(--bg-panel);
    border: 1px solid var(--border);
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    /* overflow: hidden; causes tooltip clipping */
    min-height: 0;
    /* needed for nested scroll to work without overflow hidden */
    flex: 1;
    /* Ocupar espaço disponível */
    min-width: 300px;
}

.manager-section>.section-title:first-child {
    border-top-left-radius: 11px;
    border-top-right-radius: 11px;
}

/* Ensure bottom corners for the last element (likely scroller or list) */
.manager-section>*:last-child {
    border-bottom-left-radius: 11px;
    border-bottom-right-radius: 11px;
}


.manager-feed {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 20px;
    min-height: 0;
    /* needed for nested flex scroll */
}

.box-shadowed {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

.section-title {
    padding: 15px 20px;
    margin: 0;
    border-bottom: 1px solid var(--border);
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--text-main);
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--bg-elevated);
}

.section-title.warn {
    color: var(--warn);
}

.section-title.danger {
    color: var(--bad);
}

/* Custom Scroll inside sections */
.table-scroller,
.insight-list {
    flex: 1;
    overflow-y: auto;
    padding: 0;
}

/* Manager Table */
.manager-table {
    width: 100%;
    border-collapse: collapse;
}

.manager-table th {
    background: var(--bg-body);
    position: sticky;
    top: 0;
    z-index: 10;
}

.manager-table td {
    padding: 12px 15px;
    border-bottom: 1px solid var(--border);
    font-size: 0.9rem;
}

.manager-table tr:hover td {
    background: var(--bg-elevated);
}

.score-badge {
    padding: 2px 8px;
    border-radius: 99px;
    font-size: 0.8rem;
    font-weight: 700;
    background: var(--bg-body);
    border: 1px solid var(--border);
    color: var(--text-muted);
}

.score-high {
    color: var(--good);
    border-color: rgba(16, 185, 129, 0.3);
    background: rgba(16, 185, 129, 0.05);
}

.score-med {
    color: var(--warn);
    border-color: rgba(245, 158, 11, 0.3);
    background: rgba(245, 158, 11, 0.05);
}

.score-low {
    color: var(--bad);
    border-color: rgba(239, 68, 68, 0.3);
    background: rgba(239, 68, 68, 0.05);
}

/* Insight Items */
.insight-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 15px 20px;
    border-bottom: 1px solid var(--border);
    transition: background 0.1s;
    cursor: pointer;
}

.insight-item:hover {
    background: var(--bg-elevated);
}

.insight-item:last-child {
    border-bottom: none;
}

.ii-main {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.ii-title {
    font-weight: 600;
    color: var(--text-main);
    font-size: 0.95rem;
}

.ii-sub {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.ii-action {
    font-size: 0.8rem;
    color: var(--accent);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 4px;
    opacity: 0.8;
}

.insight-item:hover .ii-action {
    opacity: 1;
}

/* Badges for Analysis */
.badge-recurrent {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    background: #450a0a;
    /* Red 950 */
    color: #fca5a5;
    /* Red 300 */
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.65rem;
    font-weight: 700;
    text-transform: uppercase;
    border: 1px solid #7f1d1d;
    margin-left: 6px;
}

.badge-missing {
    background: rgba(239, 68, 68, 0.1);
    color: var(--bad);
    border: 1px solid rgba(239, 68, 68, 0.3);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
}

.tl-dot.ok {
    background: var(--good);
    border-color: var(--good);
}

.tl-dot.late {
    background: var(--bad);
    border-color: var(--bad);
}

.tl-dot.empty {
    border-color: var(--border);
    opacity: 0.3;
}

.tl-label {
    margin-top: 5px;
    font-size: 0.6rem;
    color: var(--text-muted);
}

/* Chart Wrapper */
.chart-wrapper {
    flex-grow: 1;
    min-height: 250px;
    position: relative;
    background: var(--bg-panel);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 0;
    width: 100%;
}

.chart-wrapper canvas {
    position: absolute;
    left: 0;
    top: 0;
    width: 100% !important;
    height: 100% !important;
    padding: 10px;
}

/* =================================================================
   --- EDIT MODE (GRID) ---
   ================================================================= */

.form-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
    background: var(--bg-elevated);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid var(--border);
    margin-bottom: 25px;
    align-items: end;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-group:nth-child(1) {
    grid-column: span 1;
}

.form-group:nth-child(2) {
    grid-column: span 3;
}

.form-group:nth-child(3) {
    grid-column: span 2;
}

.form-group label {
    font-size: 0.7rem;
    color: var(--text-muted);
    font-weight: 700;
    text-transform: uppercase;
    margin-bottom: 8px;
    letter-spacing: 0.5px;
}

.input-field,
select.input-field {
    width: 100%;
    background: var(--bg-panel);
    border: 1px solid var(--border);
    color: var(--text-main);
    padding: 10px 12px;
    border-radius: 6px;
    transition: all 0.2s;
    height: 42px;
    font-family: 'Inter', sans-serif;
}

.input-field:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px var(--accent-glow);
}

.months-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 15px;
    padding-bottom: 20px;
}

.month-inp-group {
    background: var(--bg-panel);
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
    transition: transform 0.2s, border-color 0.2s;
    display: flex;
    flex-direction: column;
}

.month-inp-group:hover {
    border-color: var(--border-hover);
    transform: translateY(-3px);
}

.month-inp-group:focus-within {
    border-color: var(--accent);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.mig-header {
    background: var(--bg-elevated);
    padding: 8px 0;
    text-align: center;
    border-bottom: 1px solid var(--border);
    font-size: 0.75rem;
    font-weight: 800;
    color: var(--text-muted);
    text-transform: uppercase;
}

.month-inp-group .input-field {
    background: transparent;
    border: none;
    border-bottom: 1px dashed var(--border);
    border-radius: 0;
    text-align: center;
    font-size: 1.1rem;
    font-weight: 600;
    height: 50px;
    color: var(--text-main);
}

.month-inp-group .input-field:focus {
    box-shadow: none;
    background: rgba(59, 130, 246, 0.05);
    border-bottom-style: solid;
    border-bottom-color: var(--accent);
}

.month-inp-group .input-field::placeholder {
    color: var(--border-hover);
    opacity: 1;
    font-weight: 400;
}

.date-inp {
    width: 100%;
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-size: 0.7rem;
    text-align: center;
    cursor: pointer;
    padding: 8px 0;
    opacity: 0.6;
    transition: 0.2s;
    font-family: monospace;
}

.date-inp:hover,
.date-inp:focus {
    opacity: 1;
    color: var(--accent);
    background: var(--bg-elevated);
}

/* --- FOOTER & BOTÕES --- */
.modal-footer {
    padding: 15px 25px;
    background: var(--bg-panel);
    border-top: 1px solid var(--border);
    display: flex;
    justify-content: flex-end;
    flex-shrink: 0;
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 12px;
    gap: 15px;
}

.footer-content {
    display: flex;
    gap: 10px;
    width: 100%;
}

.footer-content.right {
    justify-content: flex-end;
}

.footer-content.split {
    justify-content: space-between;
}

.gap-10 {
    display: flex;
    gap: 10px;
}

.btn-primary {
    background: var(--accent);
    color: white;
    border: none;
    padding: 8px 20px;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.2s;
}

.btn-primary:hover {
    background: var(--accent-hover);
    box-shadow: 0 2px 10px var(--accent-glow);
}

.btn-ghost {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 8px 20px;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.2s;
}

.btn-ghost:hover {
    border-color: var(--text-muted);
    color: var(--text-main);
}

.btn-danger {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid var(--bad);
    color: var(--bad);
    padding: 8px 20px;
    border-radius: 6px;
    cursor: pointer;
}

.btn-danger:hover {
    background: var(--bad);
    color: white;
}

/* Botão PDF no Modal */
.btn-option {
    width: 100%;
    background: var(--bg-panel);
    border: 1px solid var(--border);
    color: var(--text-main);
    padding: 12px;
    border-radius: 6px;
    margin-bottom: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: 0.2s;
}

.btn-option:hover {
    border-color: var(--accent);
    background: var(--bg-elevated);
    transform: translateX(5px);
}

/* FAB */
.fab {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background: var(--accent);
    color: white;
    border: none;
    box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 90;
    transition: 0.2s;
}

.fab:hover {
    transform: scale(1.1);
    background: var(--accent-hover);
}

/* TOAST */
.toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: var(--good);
    color: #000;
    padding: 10px 30px;
    border-radius: 20px;
    font-weight: 700;
    transition: 0.4s;
    z-index: 2000;
}

.toast.show {
    transform: translateX(-50%) translateY(0);
}

.toast.wait {
    background: var(--accent);
    color: white;
}

.toast.error {
    background: var(--bad);
    color: white;
}

/* --- MINI MODAL (Mês) --- */
.centered {
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.month-stat-big .value {
    font-size: 3rem;
    font-weight: 800;
    color: var(--text-main);
}

.month-stat-row {
    display: flex;
    justify-content: space-around;
    width: 100%;
    margin: 20px 0;
    border-top: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    padding: 15px 0;
}

.delivery-badge {
    background: var(--bg-body);
    padding: 5px 15px;
    border-radius: 20px;
    border: 1px solid var(--border);
    color: var(--accent);
    display: inline-block;
    margin-top: 5px;
}

.btn-primary.full {
    width: 100%;
}

@media print {

    .main-container,
    .charts-grid,
    .chart-card {
        visibility: visible !important;
        position: relative !important;
        break-inside: avoid !important;
        background-color: #ffffff !important;
        color: black !important;
    }

    .fab,
    .app-header,
    .kpi-bar,
    .modal-overlay,
    .toast {
        display: none !important;
    }

    body {
        background-color: #fff;
    }
}

/* =================================================================
   --- AJUSTE DE TABELA - LIGHT MODE (CHIPS/QUADRADINHOS) ---
   ================================================================= */

[data-theme="light"] .cell-good {
    background-color: var(--good) !important;
    color: #ffffff !important;
    font-weight: 700;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.4);
    border-radius: 4px;
}

[data-theme="light"] .cell-bad {
    background-color: var(--bad) !important;
    color: #ffffff !important;
    font-weight: 700;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.4);
    border-radius: 4px;
}

[data-theme="light"] .cell-good:hover {
    background-color: #059669 !important;
    filter: none;
}

[data-theme="light"] .cell-bad:hover {
    background-color: #dc2626 !important;
    filter: none;
}

/* =================================================================
   --- ANIMAÇÃO DO ÍCONE DE TEMA (SPIN & SWAP) ---
   ================================================================= */
@keyframes icon-spin {
    0% {
        transform: rotate(-90deg) scale(0);
        opacity: 0;
    }

    80% {
        transform: rotate(10deg) scale(1.1);
        opacity: 1;
    }

    100% {
        transform: rotate(0) scale(1);
        opacity: 1;
    }
}

.icon-spin {
    animation: icon-spin 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    transform-origin: center;
}

/* =================================================================
   --- ANIMAÇÃO CASCATA (HOME / TABELA) ---
   ================================================================= */
@keyframes cascade-slide {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.cascade-item {
    opacity: 0;
    animation: cascade-slide 0.5s ease forwards;
}

/* Legacy tooltip block removed */

/* =================================================================
   --- ADD-ON: ANÁLISE GERENCIAL (MANAGER ANALYTICS V2) ---
   --- MELHORIA VISUAL E ESTRUTURAL ---
   ================================================================= */

/* Sobrescreve altura fixa de input-field para textareas da análise */
textarea.input-field {
    height: auto !important;
    min-height: 100px;
    /* Mais altura para escrever */
    padding: 12px;
    line-height: 1.6;
    resize: vertical;
    background-color: rgba(0, 0, 0, 0.2);
    /* Fundo sutilmente diferente para inputs */
    font-size: 0.9rem;
}

/* =================================================================
   --- CROWN ANIMATION (PERFORMANCE CHART) ---
   ================================================================= */
@keyframes crown-float {

    0%,
    100% {
        transform: translateY(0) scale(1);
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    50% {
        transform: translateY(-8px) scale(1.1);
        filter: drop-shadow(0 8px 8px rgba(0, 0, 0, 0.2));
    }
}

/* =================================================================
   --- BEST MONTH HIGHLIGHT (GOLDEN PILLAR) ---
   ================================================================= */
.best-month-badge {
    position: absolute;
    background: linear-gradient(135deg, #FFD700, #B8860B);
    color: #fff;
    font-size: 0.75rem;
    font-weight: bold;
    padding: 2px 8px;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    white-space: nowrap;
    z-index: 10;
    transform: translateX(-50%);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border: 1px solid #FFFACD;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    margin-top: -30px;
    /* Acima da barra */
}

.sparkle {
    position: absolute;
    width: 6px;
    height: 6px;
    background: #FFF;
    border-radius: 50%;
    box-shadow: 0 0 5px #FFF, 0 0 10px #FFD700;
    opacity: 0;
    pointer-events: none;
    z-index: 11;
    animation: twinkle 1.5s infinite ease-in-out;
}

/* Formato de estrela/diamante usando pseudo-elementos */
.sparkle::after {
    content: '';
    position: absolute;
    top: -2px;
    left: 2px;
    width: 2px;
    height: 10px;
    background: #FFF;
}

.sparkle::before {
    content: '';
    position: absolute;
    top: 2px;
    left: -2px;
    width: 10px;
    height: 2px;
    background: #FFF;
}

@keyframes twinkle {
    0% {
        transform: scale(0.2) rotate(0deg);
        opacity: 0;
    }

    50% {
        transform: scale(1.2) rotate(45deg);
        opacity: 1;
    }

    100% {
        transform: scale(0.2) rotate(90deg);
        opacity: 0;
    }
}

textarea.input-field:focus {
    background-color: var(--bg-panel);
    /* Acende ao focar */
}

/* Badges para o resultado da análise anterior */
.result-badge {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 6px;
    font-size: 0.7rem;
    font-weight: 700;
    text-transform: uppercase;
    margin-top: 6px;
    margin-right: 5px;
}

.result-success {
    background-color: var(--good-bg);
    color: var(--good);
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.result-fail {
    background-color: var(--bad-bg);
    color: var(--bad);
    border: 1px solid rgba(239, 68, 68, 0.3);
}

.result-neutral {
    background-color: rgba(63, 63, 70, 0.3);
    color: var(--text-muted);
    border: 1px solid var(--border);
}

/* Classes para colorir o valor principal no modal */
.val-good {
    color: var(--good) !important;
}

.val-bad {
    color: var(--bad) !important;
}

.val-neutral {
    color: var(--accent) !important;
}

/* ESTILOS ESPECÍFICOS DO MODAL DE ANÁLISE 
   Para deixá-lo menos confuso e mais hierárquico
*/

/* Container de "Resultado Anterior" com visual de cartão informativo */
#previousReviewBlock {
    background: linear-gradient(to right, var(--bg-elevated), var(--bg-panel));
    border-left: 4px solid var(--text-muted);
    /* Borda lateral para destacar */
    opacity: 0.9;
}

/* Título de seção dentro do modal */
#analysisModal h4 {
    border-bottom: 2px solid var(--border);
    padding-bottom: 8px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 8px;
}

/* Ajustes nos Labels do Modal de Análise para dar destaque */
#analysisModal .form-group label {
    color: var(--accent);
    /* Cor de destaque para saber o que preencher */
    font-size: 0.75rem;
    opacity: 0.9;
}

/* =================================================================
   --- FIX: MELHORIA VISUAL DA BOLINHA (LIGHT MODE) ---
   ================================================================= */

[data-theme="light"] td.has-analysis::after {
    /* Muda de azul para um cinza chumbo elegante */
    background-color: #52525b !important;

    /* Cria uma borda branca sólida ao redor para destacar das cores de fundo (verde/vermelho) */
    box-shadow: 0 0 0 2px #ffffff !important;

    /* Tira a transparência para ficar nítido */
    opacity: 1;

    /* Ajuste fino de tamanho e posição para ficar mais delicado */
    width: 5px;
    height: 5px;
    top: 6px;
    right: 6px;
}

/* =================================================================
   --- TOOLTIPS (Data Attribute) ---
   ================================================================= */
/* =================================================================
   --- TOOLTIPS (REIMPLEMENTAÇÃO LIMPA) ---
   ================================================================= */
[data-tooltip] {
    position: relative;
    cursor: help;
}

/* O box com o texto - SIMPLIFICADO (PARA BAIXO) */
[data-tooltip]::before {
    content: attr(data-tooltip);
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);

    /* Aparência */
    background: #27272a;
    color: #ffffff;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 0.75rem;
    font-weight: 500;
    line-height: 1.4;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border: 1px solid rgba(255, 255, 255, 0.1);

    /* Layout */
    width: max-content;
    max-width: 250px;
    white-space: pre-wrap;
    text-align: center;
    pointer-events: none;

    /* Z-INDEX e Posição */
    z-index: 100001;
    margin-top: 6px;

    /* Animação */
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
}

/* Hover State */
[data-tooltip]:hover::before {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(2px);
}

/* Fix Ranking Table Text Overflow */
.manager-table td {
    white-space: normal;
    overflow: visible;
    text-overflow: clip;
    vertical-align: middle;
}

/* Fix Tooltip Z-Index Clipping */
.manager-header-grid {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    gap: 15px;
    margin-bottom: 25px;
    position: relative;
    /* Create stacking context */
    z-index: 200;
    /* Ensure it stays above everything below it */
}

/* Medalhas - Design Moderno e Discreto (Flat & Subtle) */
.rank-medal {
    display: inline-flex;
    /* Fix centering: acts like text now */
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border-radius: 8px;
    /* Slightly more rounded */
    vertical-align: middle;
    /* Aligns with text baseline */
}

/* Ensure SVG icons act as expected */
.rank-medal svg,
.rank-medal i {
    width: 18px;
    height: 18px;
    stroke-width: 2.5px;
    /* Make icons bolder */
    stroke: currentColor;
    /* Force color inheritance */
}

/* Gold */
.medal-gold {
    background: rgba(251, 191, 36, 0.15);
    /* Amber-400 opacity */
    color: #fbbf24;
    /* Amber-400 */
    box-shadow: 0 0 0 1px rgba(251, 191, 36, 0.2);
    /* Subtle contour */
}

/* Silver */
.medal-silver {
    background: rgba(228, 228, 231, 0.15);
    /* Zinc-200 opacity */
    color: #e4e4e7;
    /* Zinc-200 */
    box-shadow: 0 0 0 1px rgba(228, 228, 231, 0.2);
}

/* Bronze */
.medal-bronze {
    background: rgba(253, 186, 116, 0.15);
    /* Orange-300 opacity */
    color: #fdba74;
    /* Orange-300 */
    box-shadow: 0 0 0 1px rgba(253, 186, 116, 0.2);
}

.rank-text {
    font-weight: 700;
    font-size: 0.9rem;
    color: var(--text-muted);
}

/* =================================================================
   --- MINI KPI (Header dos Gráficos) ---
   (Copiado de mini-kpi.css)
   ================================================================= */
.chart-header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border);
}

.chart-header-row h3 {
    margin: 0;
}

.mini-kpi-group {
    display: flex;
    gap: 20px;
    align-items: center;
}

.mini-kpi {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    line-height: 1.2;
}

.mk-label {
    font-size: 0.65rem;
    text-transform: uppercase;
    color: var(--text-muted);
    font-weight: 600;
}

.mk-val {
    font-size: 1rem;
    font-weight: 700;
    color: var(--text-main);
}

.mini-kpi.danger .mk-val {
    color: var(--bad);
}

/* =================================================================
   --- UTILITY CLASSES (Refactored from inline styles) ---
   ================================================================= */

.flex-center-gap {
    display: flex;
    gap: 10px;
    align-items: center;
}

.flex-gap-8 {
    display: flex;
    gap: 8px;
}

.flex-gap-12 {
    display: flex;
    align-items: center;
    gap: 12px;
}

.nps-container {
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 75vh;
    padding-top: 20px;
    animation: fadeIn 0.3s ease;
}

.nps-card-full {
    border: 1px solid var(--border);
    position: relative;
    padding: 40px;
    width: 98%;
    max-width: 1200px;
    background: var(--bg-panel);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

.nps-header-group {
    text-align: center;
    margin-bottom: 30px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.nps-icon {
    width: 24px;
    height: 24px;
    opacity: 0.9;
}

.nps-title {
    margin: 0;
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--text-main);
    letter-spacing: -0.5px;
}

.nps-subtitle {
    font-size: 1rem;
    color: var(--text-muted);
    margin-top: 8px;
}

.chart-box-large {
    height: 450px;
    width: 100%;
}

.nps-controls {
    display: flex;
    gap: 15px;
    margin-top: 30px;
}

.btn-outline {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 10px 20px;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s;
}

.btn-outline:hover {
    border-color: var(--text-main);
    color: var(--text-main);
}